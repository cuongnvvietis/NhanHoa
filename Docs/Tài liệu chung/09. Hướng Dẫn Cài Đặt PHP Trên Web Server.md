
# Hướng Dẫn Cài Đặt PHP Trên Web Server

Dưới đây là hai cách cấu hình PHP trên web server: **sử dụng PHP-FPM** và **sử dụng PHP Module**.

---

## **Hướng Dẫn 1: Sử Dụng PHP-FPM**

PHP-FPM là cách cấu hình phổ biến hiện nay, hỗ trợ hiệu năng cao và sử dụng được cho cả **Nginx** và **Apache**.

### **1. Cài Đặt Web Server và PHP-FPM**
#### Cài đặt Nginx hoặc Apache:
```bash
sudo apt update
sudo apt install -y nginx
# Hoặc Apache:
# sudo apt install -y apache2
```

#### Cài đặt PHP-FPM và các module PHP:
Ví dụ: PHP 8.1
```bash
sudo apt install -y php8.1 php8.1-fpm php8.1-mysql
```

Khởi động PHP-FPM:
```bash
sudo systemctl start php8.1-fpm
sudo systemctl enable php8.1-fpm
sudo systemctl status php8.1-fpm
```

---

### **2. Cấu Hình PHP-FPM Với Nginx**
Mở file cấu hình Nginx:
```bash
sudo nano /etc/nginx/sites-available/default
```

Cập nhật cấu hình như sau:
```nginx
server {
    listen 80;
    server_name example.com;
    root /var/www/html;

    index index.php index.html index.htm;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/run/php/php8.1-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.ht {
        deny all;
    }
}
```

Lưu file và kiểm tra cấu hình:
```bash
sudo nginx -t
```

Khởi động lại Nginx:
```bash
sudo systemctl restart nginx
```

---

### **3. Cấu Hình PHP-FPM Với Apache**
Nếu bạn muốn dùng PHP-FPM với Apache (thay vì `mod_php`), cấu hình như sau:

1. Cài đặt module Apache hỗ trợ PHP-FPM:
   ```bash
   sudo apt install -y libapache2-mod-fcgid
   sudo a2enmod proxy_fcgi setenvif
   sudo a2enconf php8.1-fpm
   sudo systemctl restart apache2
   ```

2. Đảm bảo file cấu hình VirtualHost của Apache (ví dụ: `/etc/apache2/sites-available/000-default.conf`) có nội dung:
   ```apache
   <VirtualHost *:80>
       ServerName example.com
       DocumentRoot /var/www/html

       <FilesMatch \.php$>
           SetHandler "proxy:unix:/run/php/php8.1-fpm.sock|fcgi://localhost/"
       </FilesMatch>
   </VirtualHost>
   ```

3. Kiểm tra cấu hình và khởi động lại Apache:
   ```bash
   sudo apache2ctl configtest
   sudo systemctl restart apache2
   ```

---

## **Hướng Dẫn 2: Sử Dụng PHP Module (mod_php) Cho Apache**

Cách này sử dụng PHP như một module tích hợp trực tiếp trong Apache. Nó không dùng được với Nginx.

### **1. Cài Đặt Apache và PHP Module**
1. Cài đặt Apache:
   ```bash
   sudo apt update
   sudo apt install -y apache2
   ```

2. Cài đặt PHP và module PHP:
   Ví dụ: PHP 8.1
   ```bash
   sudo apt install -y php8.1 libapache2-mod-php8.1 php8.1-mysql
   ```

3. Kiểm tra phiên bản PHP:
   ```bash
   php -v
   ```

---

### **2. Cấu Hình Apache Để Hỗ Trợ PHP Module**
1. Kích hoạt module PHP:
   ```bash
   sudo a2enmod php8.1
   sudo systemctl restart apache2
   ```

2. Đảm bảo file cấu hình `/etc/apache2/mods-enabled/dir.conf` ưu tiên xử lý file PHP:
   ```apache
   <IfModule mod_dir.c>
       DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm
   </IfModule>
   ```

3. Khởi động lại Apache:
   ```bash
   sudo systemctl restart apache2
   ```

---

### **3. Tạo File PHP Kiểm Tra**
Dùng cho cả hai cách trên (PHP-FPM hoặc PHP Module):
1. Tạo file `index.php` trong thư mục gốc web server:
   ```bash
   echo "<?php phpinfo(); ?>" | sudo tee /var/www/html/index.php
   ```

2. Đảm bảo quyền truy cập:
   ```bash
   sudo chown -R www-data:www-data /var/www/html
   sudo chmod -R 755 /var/www/html
   ```

3. Truy cập `http://<IP hoặc domain>/index.php` để kiểm tra.

---

## **So Sánh PHP-FPM và PHP Module**
| **Tiêu chí**            | **PHP-FPM**                                   | **PHP Module (mod_php)**                     |
|--------------------------|-----------------------------------------------|-----------------------------------------------|
| **Hiệu năng**            | Cao hơn, tối ưu cho nhiều request đồng thời. | Phù hợp cho các ứng dụng nhỏ, đơn giản.       |
| **Hỗ trợ Web Server**    | Nginx và Apache                              | Chỉ Apache                                   |
| **Quản lý tài nguyên**   | Tốt hơn nhờ sử dụng process riêng.           | Chia sẻ cùng process với Apache.             |
| **Khả năng tùy chỉnh**   | Tùy chỉnh dễ dàng với nhiều pool.            | Ít tùy chỉnh hơn.                            |

---

Nếu bạn cần thêm hỗ trợ hoặc thông tin chi tiết hơn, hãy liên hệ!
